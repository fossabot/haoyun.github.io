<!doctype html>
<html class="no-js" lang="en">
    <head>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61795702-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-61795702-1');
</script>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Technical Notes - Natural Stupidity</title>
        <link rel="stylesheet" href="../../../../../../css/blog_main.css" />
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css">
        <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
            <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
            <div class="title-bar-title">Menu</div>
        </div>

	    <!-- nav section -->
        <div class="top-bar" id="responsive-menu">
		    <div class="grid-container" style="flex-grow:1;">
		        <div class="grid-x">
		            <div class="top-bar-left">
						    <!--<div class="menu-text">Natural Stupidity</div>
							<li class="menu-text" style="padding-top:0px;padding-bottom:0px;">
                                <a href="/" style="padding:0;"><img alt="facepalm" width="36" height="36" src="/images/facepalm.png"/></a></li>
                                -->
                                <ul class="menu">
                            <li class>
                                <a href="../../../../../../">Natural Stupidity</a>
                            </li></ul>
		            </div>
		            <div class="top-bar-right">
                        <ul class="menu" data-dropdown-menu>
                            <li><a href="../../../../../../n/">Home</a></li>
                            <li><a href="../../../../../../n/about/">About</a></li>
                            <li><a href="../../../../../../n/contact/">Contact</a></li>
                            <li><a href="../../../../../../n/archive/">Archive</a></li>
                        </ul>
		            </div>
	            </div>
		    </div>
        </div>

		<!-- main section -->


        <article>
    <div class="grid-container" style="min-height:100vh" id="main">
        <div class="grid-y posts">
            <section class="cell">
    <div class="header">
        <h1>Technical Notes</h1>
        <p>
            <i class="far fa-calendar"></i>&nbsp;August 23, 2017&nbsp;
            
            <i class="far fa-user"></i>&nbsp;Yun Hao&nbsp;
            
            
            <i class="fas fa-history"></i>&nbsp;<a href="https://github.com/haoyun/haoyun.github.io/commits/source/src_site/n/posts/2017-08-23-Technical-Notes.markdown">History</a>&nbsp;
            
            
            <i class="fas fa-code"></i>&nbsp;<a href="https://raw.githubusercontent.com/haoyun/haoyun.github.io/5b1e301/src_site/n/posts/2017-08-23-Technical-Notes.markdown">5b1e301</a>
            
        </p>
    </div>
    <div>
        <p>This post is used to record what I have done to build up this project out of the original, basic, official templates of Hakyll and Foundation.</p>
<!--more-->
<h2 id="how-was-this-project-initialized">How was this project initialized?</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ex">hakyll-init</span> Hakyll-Foundation</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="bu">cd</span> Hakyll-Foundation</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="ex">foundation</span> new --framework sites --directory Foundation --template basic</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="fu">git</span> init</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="fu">git</span> remote add origin git@github.com:haoyun/Hakyll-Foundation.git</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="fu">git</span> commit --allow-empty -m <span class="st">&quot;dummy first commit&quot;</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="fu">git</span> push origin master</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="fu">git</span> checkout --orphan source</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="fu">git</span> submodule add git@github.com:haoyun/Hakyll-Foundation.git html_public</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="fu">git</span> commit -m <span class="st">&quot;add submodule&quot;</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="fu">git</span> push origin source</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#cd html_public</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#git commit --allow-empty -m 'update'</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#git push origin master</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#cd ..</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="fu">git</span> add .</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="fu">git</span> commit -m <span class="st">'source update'</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="fu">git</span> push origin source</a></code></pre></div>
<h3 id="restruture-the-wroking-directory">Restruture the Wroking Directory</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ex">.</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">├── <span class="ex">dist</span>                                # distribution</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">├── <span class="ex">Foundation</span>                          # Zurb Foundation SCSS files</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">├── <span class="ex">Hakyll-Foundation.cabal</span>             # cabal file</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">├── <span class="ex">html_public</span>                         # generated site for publishing</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">├── <span class="ex">LICENSE</span>                             # license</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">├── <span class="ex">README.md</span>                           # readme</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">├── <span class="ex">src</span>                                 # all Haskell files and pandoc filters</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">│   └── <span class="ex">site.hs</span>                         </a>
<a class="sourceLine" id="cb2-10" data-line-number="10">└── <span class="ex">src_site</span>                            # all source code for the site</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    ├── <span class="ex">css</span>                             # css files, possibly generated by Foundation</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">    │   └── <span class="ex">...</span>        </a>
<a class="sourceLine" id="cb2-13" data-line-number="13">    ├── <span class="ex">images</span>                          # images</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">    │   └── <span class="ex">...</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    ├── <span class="ex">posts</span>                           # blog posts</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">    │   ├── <span class="ex">2015-08-12-spqr.markdown</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">    │   └── <span class="ex">...</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">    ├── <span class="ex">templates</span>                       # tempate files</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">    │   ├── <span class="ex">default.html</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20">    │   └── <span class="ex">...</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">    ├── <span class="ex">index.html</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    └── <span class="ex">...</span></a></code></pre></div>
<h3 id="change-configurations">Change Configurations</h3>
<ul>
<li>In <code>Foundation</code> folder, the configuration file <code>gulpfile.js</code> controls the output directory of the CSS file.</li>
</ul>
<pre class="nodejs"><code>.pipe(gulp.dest('../src_site/css'));</code></pre>
<ul>
<li>To make sure that hakyll will find all the Hakyll source files that are put under the <code>./scr</code> directory, there are two files to change. The first is the ‘.cabal’ file.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="er">main-is:</span>          <span class="er">site.hs</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="er">Hs-source-dirs:</span>   <span class="er">src</span></a></code></pre></div>
<p>The second is the <code>main.hs</code> file. We have to change Hakyll’s Configuration. So in replacement of the default <code>hakyll $ do</code>, which will run hakyll with <code>defaultConfiguration</code>, we need to write</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">main <span class="fu">=</span> hakyllWith hfConfiguration <span class="fu">$</span> <span class="kw">do</span></a></code></pre></div>
<p>and define the customized configurations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ot">hfConfiguration ::</span> <span class="dt">Configuration</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">hfConfiguration <span class="fu">=</span> defaultConfiguration</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">    {   </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">        providerDirectory    <span class="fu">=</span> <span class="st">&quot;./src_site&quot;</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">    }</a></code></pre></div>
<p>The above is adapted from <a href="https://hackage.haskell.org/package/hakyll-4.9.8.0/docs/Hakyll-Core-Configuration.html"><code>Hakyll.Core.Configuration</code></a>. As we can see, there are many configurations that we can modify according to our need. Most importantly, if <code>Foundation</code> is inside the <code>providerDirectory</code>, one has to use ignoreFile to ignore it. Otherwise, it takes an extremely long time to generate the site.</p>
<h3 id="url-without-.html">Url without <code>.html</code></h3>
<p>There are many solutions available on the Internet.</p>
<ul>
<li><a href="https://aherrmann.github.io/programming/2016/01/31/jekyll-style-urls-with-hakyll/">This one</a> seems to be the best solution.</li>
</ul>
<p>This solution makes Hakyll to generate the <em>correct</em> url in the very beginning, rather than modify the <em>wrong</em> url that has been put into the html files. The latter approach has the potential that it does not correct all urls, and that it may also introduce mistakes for the urls that should be in their original form.</p>
<p>Other solutions are</p>
<ul>
<li><a href="https://www.rohanjain.in/hakyll-clean-urls/">Alternative 1</a></li>
<li><a href="http://alexanderlobov.ru/posts/2017-02-05-hakyll-clean-urls/">Alternative 2</a></li>
</ul>
<h3 id="restrucure">Restrucure</h3>
<h3 id="reminder">Reminder</h3>
<p>This is a post about TikZ.</p>
<ul>
<li>https://skybluetrades.net/blog/posts/2013/11/25/the-teeny-tiny-happy-hakyll-tikz-pixie.html</li>
</ul>
<p>The source code of it show how to add new commands to the main program. It’s better to create a command like</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ex">cabal</span> run newpost</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="ex">?</span> Title:</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="ex">?</span> Author:</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="ex">?</span> Tag (separated by comma)<span class="bu">:</span></a></code></pre></div>
<p>to create a new post (and metadata file) based on a template file.</p>
<ul>
<li>https://www.gwern.net/About</li>
</ul>
<p>This is another well programmed site.</p>
<p>To display full/part instead of just titles on the home page, see for examle:</p>
<ul>
<li>https://github.com/travisbrown/metaplasm</li>
<li>https://github.com/aherrmann/aherrmann.github.io.hakyll</li>
</ul>
    </div>
</section>

<section>
    <script>
var idcomments_acct = '3eb5e7864d2f0dc9d1586c6209453d5d';
var idcomments_post_id;
var idcomments_post_url = '/n/posts/2017/08/23/Technical-Notes';
</script>
<span id="IDCommentsPostTitle" style="display:none"></span>
<script type="text/javascript" src="https://www.intensedebate.com/js/genericCommentWrapperV2.js"></script>

</section>
        </div>
    </div>
</article>



		<!-- Footer -->
<a href="javascript:void(0);" id="rocketmeluncur" class="showrocket"><i></i></a>

<footer>
    <div class="grid-container">
        <div class="grid-x grid-padding-x grid-padding-y">
            <!--<div class="cell medium-4">
                <h6>About Yun Hao</h6>
            </div>-->
            <div class="cell medium-8">
                <h5>About the site</h5>
                <p>This static site is generated by
                <a href="//jaspervdj.be/hakyll/">Hakyll</a> from
                <a href="//pandoc.org/">Pandoc</a>'s extended
                <a href="//daringfireball.net/projects/markdown/">Markdown</a>.
                Stylesheets are built with
                <a href="//foundation.zurb.com/">Zurb Foundation</a><!--
                with <a href="http://ethanschoonover.com/solarized">Solarized</a>
                color-scheme-->. The site, including source codes, is hosted on
                <a href="//pages.github.com">Github Pages</a>.</p>
                
                <p>
                    Compiled from commit <a href="https://raw.githubusercontent.com/haoyun/haoyun.github.io/5b1e301/src_site/n/posts/2017-08-23-Technical-Notes.markdown">5b1e301</a>.
                </p>
            </div>
            <div class="cell medium-4">
                <h5>Links</h5>
                <ul>
                    <li><a href="//push2kindle-154021.appspot.com/">KindleEar</a></li>
                    <!--<li><a href="//haoyun.000webhostapp.com/piwik/index.php">Piwik</a></li>-->
                    <!--<li><a href="/s/notes/">Notes</a></li>-->
                    <li><a href="../../../../../../s/links/">Links</a></li>
                    <li><a href="../../../../../../s/tools/">Tools</a></li>
                    <li><a href="../../../../../../comment/">Leave a Comment</a>
                </ul>
            </div>
        </div>
        
    </div>
    <div class="footer-copyright">
        <div class="grid-container">
            <div class="grid-x grid-padding-x grid-margin-y">
                <div class="cell">
                    © 2017 Yun Hao &lt;<a href="mailto:haoyun_public@163.com">haoyun_public@163.com</a>&gt;
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- fork on github
<div class="show-for-medium">
<a href="https://github.com/haoyun/haoyun.github.io/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</div>
-->
<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(101019144); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101019144ns.gif" /></p></noscript>

<!-- JavaScript -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/js/foundation.js"></script>
<script src="../../../../../../js/app.js"></script>
<script>
    hljs.initHighlightingOnLoad();
    $(document).foundation();
</script>


    </body>
</html>