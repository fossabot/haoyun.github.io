---
title: Technical Notes
author: Yun Hao
---

This post is used to record what I have done to build up this project out of
the original, basic, official templates of Hakyll and Foundation.

## How was this project initialized? ##

```bash
hakyll-init Hakyll-Foundation
cd Hakyll-Foundation
foundation new --framework sites --directory Foundation --template basic
git init
git remote add origin git@github.com:haoyun/Hakyll-Foundation.git
git commit --allow-empty -m "dummy first commit"
git push origin master
git checkout --orphan source
git submodule add git@github.com:haoyun/Hakyll-Foundation.git html_public
git commit -m "add submodule"
git push origin source
#cd html_public
#git commit --allow-empty -m 'update'
#git push origin master
#cd ..
git add .
git commit -m 'source update'
git push origin source
```

### Restruture the Wroking Directory

```bash
.
├── dist                                # distribution
├── Foundation                          # Zurb Foundation SCSS files
├── Hakyll-Foundation.cabal             # cabal file
├── html_public                         # generated site for publishing
├── LICENSE                             # license
├── README.md                           # readme
├── src                                 # all Haskell files and pandoc filters
│   └── site.hs                         
└── src_site                            # all source code for the site
    ├── css                             # css files, possibly generated by Foundation
    │   └── ...        
    ├── images                          # images
    │   └── ...
    ├── posts                           # blog posts
    │   ├── 2015-08-12-spqr.markdown
    │   └── ...
    ├── templates                       # tempate files
    │   ├── default.html
    │   └── ...
    ├── index.html
    └── ...
```

### Change Configurations

* In `Foundation` folder, the configuration file `gulpfile.js` controls
  the output directory of the CSS file.
  
```nodejs
.pipe(gulp.dest('../src_site/css'));
```

* To make hakyll find the files, there are two files to change. The first
  is the '.cabal' file.
  
```json
  main-is:          ./src/site.hs
```

  The second is the `main.hs` file. We have to change the
  `defaultConfiguration`. Instead of using the default `hakyll $ do`, use

```haskell
main = hakyllWith hfConfiguration $ do
````

  and define the customized configurations.

```haskell
hfConfiguration :: Configuration
hfConfiguration = defaultConfiguration
    {   
        providerDirectory    = "./src_site"
    }
```

  The above is apdated from
   [`Hakyll.Core.Configuration`][Hakyll.Core.Configuration].
  As we can see, there are many configurations that we can modify
  according to our need. Most imprtantly, if `Foundation` is inside the
  `providerDirectory`, one has to use ignoreFile to ignore it. Otherwise,
  it takes an extremely long time to generate the site.

### Url without `.html`

There are many solutions available on the Internet.

* [This one][jekyll-url]
 seems to be the best solution.

This solution really makes Hakyll to generate the *correct* url in the very
beginning, rather than modify the *wrong* url that has ben put into the html
files. The latter approch has the potential that it does not correct all urls,
and that it may also introduce mistakes for the urls that should be in their
original form.

Other solutions are.

* [Alternative 1](https://www.rohanjain.in/hakyll-clean-urls/)
* [Alternative 2](http://alexanderlobov.ru/posts/2017-02-05-hakyll-clean-urls/)


### Restrucure

### Reminder

This is a post about TikZ.

* https://skybluetrades.net/blog/posts/2013/11/25/the-teeny-tiny-happy-hakyll-tikz-pixie.html

The source code of it show how to add new commands to the main program.
It's better to creat a command like

```bash
cabal run newpost
? Title:
? Author:
? Tag (separated by comma):
```

to creat a new post (and metada file) according to a predesigned template file.

* https://www.gwern.net/About

This is another well programmed site.



[Hakyll.Core.Configuration]: https://hackage.haskell.org/package/hakyll-4.9.8.0/docs/Hakyll-Core-Configuration.html
[jekyll-url]: https://aherrmann.github.io/programming/2016/01/31/jekyll-style-urls-with-hakyll/